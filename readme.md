# Cortex ᵃˡᵖʰᵃ ![Release](https://img.shields.io/github/v/release/hepller/cortex)

> RNN LTSM нейросеть для имитации общения

![Size](https://img.shields.io/github/repo-size/hepller/cortex)
![License](https://img.shields.io/github/license/hepller/cortex)

## Описание

_Cortex_ — Простая нейросеть для имитации диалога по принципу Вопрос/Ответ с встроенным интерфейсом командной строки (CLI)

> Написано на Python с использованием библиотек [Keras](https://keras.io/) (+ [TensorFlow](https://www.tensorflow.org/)), [NLTK](https://www.nltk.org/) и [NumPy](https://numpy.org/) _на основе https://github.com/bartosz-paternoga/Chatbot_

## Зависимости

- Python 3.10 и новее _(Совместимость с более ранними версиями не проверялась)_

_Дополнительные зависимости указаны в [`requirements.txt`](requirements.txt)_

## Установка и запуск

### Подготовка датасета

Перед запуском необходимо директорию `extra/data` и файл `extra/data/data.json`

Далее нужно подготовить датасет  по которому будет обучаться модель

Пример элементов датасета:

```json5
[
  {
    "question": "Докажи", // Начальное высказывание.
    "answer": "Не обязан" // Ответ на высказывание.
  },
  {
    "question": "Кто",
    "answer": "Я"
  },
  
  // ...
]
```

_Допустимо наличие элементов с одинаковым начальным высказыванием, но разными ответами_

### Конфигурация

После подготовки датасета необходимо открыть конфигурацию в файле `extra/config.yml` и установить необходимые вам значения

### Обучение нейросети

Для запуска нейросети нужно поочередно ввести команды в терминал:

```bash
# Установка зависимостей
$ pip install -r requirements.txt

# Для обучения на CPU можно использовать tensorflow-cpu, вместо обычного tensorflow.

# Переход в директорию дополнительных скриптов.
$ cd extra

# Подготовка данных для обучения модели.
$ python preprocess.py

# Обучение модели нейросети.
$ python train.py
```

### Интерфейсы для взаимодействия

#### CLI

```bash

# Переход в директорию доп. скриптов.
$ cd extra

# Запуск интерфейса командной строки (CLI).
$ python cli.py
```

_Для выхода из CLI введите: `/exit`_

#### API

```bash

# Переход в директорию доп. скриптов.
$ cd extra

# Запуск API-сервера
$ python api_server.py
```

Запрос к API должен выглядеть так: `http://127.0.0.1:5000/api?query=<текст_запроса>` _(порт, на котором запускается API можно указать в конфигурации)_

## Дополнительная информация

Описание содержимого директории модели (по умолчанию: `extra/model`)

```yaml
model.h5 # Данные весов нейросети (появляется после завершения обучения).
both.pkl # Дамп данных валидации + данных тренировки.
test.pkl # Дамп данных для валидации нейросети при обучении.
train.pkl # Дамп данных для тренировки нейросети.
```

## Лицензия

Copyright © 2022 [hepller](https://github.com/hepller)

Проект распространяется под лицензией [MIT](license)
