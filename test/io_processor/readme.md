# Тестирование I/O процессора

1. [Установка и запуск](#установка-и-запуск)
   1. [Подготовка датасета](#подготовка-датасета)
   2. [Обучение нейросети](#обучение-нейросети)
2. [CLI](#cli)
3. [Дополнительная информация](#дополнительная-информация)

## Установка и запуск

### Подготовка датасета

Сбор данных при помощи коллектора датасета:

```python
# ...

# Укажите токен.
bot: User = User(token="TOKEN")

# ...
```

```shell
$ python dataset_collector.py
```

Пример элементов датасета:

```json5
[
  {
    // Начальное высказывание.
    "input": "Докажи",
    // Варианты ответа на высказывание.
    "outputs": [
       "Не обязан",
       "Ещё что"
    ]
  },
  {
    "input": "Кто",
    "outputs": [
       "Я",
       "Не знаю"
    ]
  },
  // ...
]
```

### Обучение нейросети

Для обучения нейросети нужно поочередно ввести команды в терминал:

```shell
# Подготовка данных для обучения модели.
$ python preprocess.py
# Аргументы:
#   --dataset-size, -ds : Размер датасета (по умолчанию: 256).
#   --model-dir, -md : Путь к директории модели (по умолчанию: model).
#   --dataset-filename, -df : Имя файла датасета (по умолчанию: data/data.json).

# Обучение модели нейросети.
$ python train.py
# Аргументы:
#   --epochs-count, -ec : Кол-во эпох (по умолчанию: 300).
#   --batch-size, -bs : Размер батча (по умолчанию: 64).
#   --overtrain, -o : Дообучение существующей модели, вместо создания новой (по умолчанию: false).
#   --model-dir, -md : Путь к директории модели (по умолчанию: model).
#   --model-name, -mn : Имя модели нейросети (по умолчанию: cortex-test).
```

## Взаимодействие

### CLI

```shell
# Запуск интерфейса командной строки (CLI).
$ python cli.py
# Аргументы:
#   --model-dir, -md : Путь к директории модели (по умолчанию: model).
```

*Для выхода из CLI введите: `/exit`*

## Дополнительная информация

Описание содержимого директории модели *(по умолчанию: `test/model`)*:

```yaml
model.h5 # Данные весов нейросети (появляется после завершения обучения).
both.pkl # Дамп данных для валидации + данных для тренировки.
test.pkl # Дамп данных для валидации нейросети при обучении.
train.pkl # Дамп данных для тренировки нейросети.
```