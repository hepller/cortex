# Дополнительные скрипты

В данной директории находятся дополнительные скрипты для тестирования

1. [Установка и запуск](#установка-и-запуск)
   1. [Подготовка датасета](#подготовка-датасета)
   2. [Конфигурация](#конфигурация)
   3. [Обучение нейросети](#обучение-нейросети)
2. [Взаимодействие](#взаимодействие)
   1. [CLI](#cli)
   2. [API](#api)
3. [Дополнительная информация](#дополнительная-информация)

## Установка и запуск

### Подготовка датасета

Перед запуском необходимо создать директорию `extra/data` и файл `extra/data/data.json`

Далее нужно подготовить датасет по которому будет обучаться модель

Пример элементов датасета:

```json5
[
  {
    // Начальное высказывание.
    "question": "Докажи",
    // Ответ на высказывание.
    "answer": "Не обязан"
  },
  {
    "question": "Кто",
    "answer": "Я"
  },
  // ...
]
```

_Допустимо наличие элементов с одинаковым начальным высказыванием, но разными ответами_

### Конфигурация

После подготовки датасета необходимо открыть конфигурацию в файле `extra/config.yml` и установить необходимые вам
значения

### Обучение нейросети

Для запуска нейросети нужно поочередно ввести команды в терминал:

```shell
# Переход в директорию дополнительных скриптов.
$ cd extra

# Подготовка данных для обучения модели.
$ python preprocess.py

# Обучение модели нейросети.
$ python train.py
```

## Взаимодействие

### CLI

```shell
# Переход в директорию доп. скриптов.
$ cd extra

# Запуск интерфейса командной строки (CLI).
$ python cli.py
```

_Для выхода из CLI введите: `/exit`_

### API

Запуск в тестовом режиме:

```shell
# Переход в директорию доп. скриптов.
$ cd extra

# Запуск API-сервера
$ python api_server.py
```

Запрос к API должен выглядеть так: `http://127.0.0.1:5000/api?query=<текст_запроса>` _(порт, на котором запускается API
можно указать в конфигурации)_

Пример успешного ответа на запрос:

```json
{
  "output": "с",
  "query": "1",
  "status": "success"
}
```

Пример ошибки _(в данном случае - при отсутствии аргумента `query`)_:

```json
{
  "error_text": "No query field provided. Please specify an query.",
  "status": "error"
}
```

## Дополнительная информация

Описание содержимого директории модели _(по умолчанию: `extra/model`)_

```yaml
model.h5 # Данные весов нейросети (появляется после завершения обучения).
both.pkl # Дамп данных для валидации + данных для тренировки.
test.pkl # Дамп данных для валидации нейросети при обучении.
train.pkl # Дамп данных для тренировки нейросети.
```
